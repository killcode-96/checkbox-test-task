# API для чеків (тестове завдання для Checkbox)

## Огляд

Цей проєкт реалізує REST API для створення та управління чеками, побудований з використанням FastAPI, SQLAlchemy та PostgreSQL. Він включає реєстрацію користувачів, автентифікацію за допомогою JWT (JSON Web Tokens), створення чеків, перегляд списку чеків, фільтрацію, пагінацію та публічний перегляд чеків. Проєкт створено як рішення тестового завдання для Checkbox.

## Функціональність

*   **Автентифікація користувачів:**
    *   Реєстрація користувачів із безпечним хешуванням паролів (bcrypt).
    *   Вхід користувачів та генерація JWT.
    *   Захищені ендпоінти, що вимагають автентифікації JWT.
*   **Управління чеками:**
    *   Створення чеків з декількома товарами (назва, ціна, кількість).
    *   Перегляд списку чеків з фільтрацією (за датою, сумою, типом оплати) та пагінацією.
    *   Отримання інформації про окремий чек за ID (для автентифікованих користувачів).
    *   Публічний перегляд чека за унікальним коротким посиланням (без автентифікації).
*   **База даних:**
    *   База даних PostgreSQL з використанням SQLAlchemy (асинхронно).
    *   Міграції бази даних за допомогою Alembic.
*   **Документація API:**
    *   Автоматично згенерована інтерактивна документація API за допомогою Swagger UI (`/docs`) та ReDoc (`/redoc`).
*   **Тестування:**
    *   Юніт-тести з використанням pytest.
*   **Асинхронність:** Використовує `asyncio` та `async`/`await` для підвищення продуктивності.

## Передумови

*   Python 3.13
*   Poetry 2.0.0+ (для керування залежностями)
*   PostgreSQL 17 (встановлена та запущена)
*   Docker (опціонально)

## Встановлення та налаштування

1.  **Клонуйте репозиторій:**

    ```bash
    git clone https://github.com/killcode-96/checkbox-test-task.git
    cd checkbox-test-task
    ```

2.  **Створіть та активуйте віртуальне середовище (за допомогою Poetry):**

    ```bash
    poetry install
    poetry shell
    ```

3.  **Створіть файл `.env`:**

      * Створіть файл `.env` в кореневому каталозі проєкту.
      * Скопіюйте вміст з файлу `.env.example` у файл `.env`.
      * Заповніть `.env` вашими *фактичними* значеннями (реквізити доступу до бази даних, секретний ключ, тощо).

4.  **Створіть базу даних PostgreSQL за допомогою SQL Shell(psql):**

    ```bash
    CREATE USER checkbox_test_task_test_user with password 'checkbox_test_task_test_password';
    CREATE DATABASE checkbox_test_task_test_db OWNER checkbox_test_task_test_user;
    GRANT ALL PRIVILEGES ON DATABASE checkbox_test_task_test_db to checkbox_test_task_test_user;
    ```

6.  **Запустіть міграції бази даних:**

    ```bash
    alembic upgrade head
    ```

## Запуск додатку

```bash
uvicorn app.main:app --reload
```

* Інтерактивна документація API (Swagger UI) буде доступна за адресою http://localhost:8000/docs.
* Альтернативна документація API (ReDoc) буде доступна за адресою http://localhost:8000/redoc.


## Тестування
Запуск тестів
```bash
pytest
```

## Docker
Створення та запуск контейнерів (тестування краще проводити всередині контейнеру)
```bash
docker-compose up -d
```


